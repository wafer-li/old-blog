---
title: 计算机网络考试速记
date: 2017-01-08
category: 复习
tags:
    - 复习
    - 计算机网络
mathjax: true
---

## 1. OSI 参考模型

从低到高：

1. 物理层

    >  通信信道的原始 **比特**，机械、电子、时序、物理介质

2. 数据链路层

    > 数据帧，控制对共享信道的访问（介质访问控制子层）

<!-- more -->

3. 网络层

    > 控制子网的运行，数据包的端到端传输，路由算法，处理拥塞
4. 传输层

    > 向会话层提供服务，为应用层提供抽象，与网络层一起处理拥塞
5. 会话层

    > 令牌管理，同步，崩溃恢复
6. 表示层

    > 传递信息的语法和语义，统一不同计算机的数据格式并提供抽象接口。
7. 应用层

    > OSI 最顶层，通常包含用户需要的各种协议，如 HTTP


## 2. TCP/IP 参考模型

1. 链路层

    > 实际上是一个接口，而不是层
2. 互联网层

    > 大致对应 OSI 网络层
3. 传输层

    > OSI 中的传输层
4. 应用层

    > TCP/IP 中没有会话层和表示层，应用层将其整合了。

与 OSI 的对比


OSI  |  TCP/IP
-----|-----|
 应用层 |  应用层
 表示层 |  &nbsp;
 会话层 |  &nbsp;
 传输层 |  传输层
 网络层 |  互联网层
 数据链路层 |  &nbsp;
 物理层 | &nbsp;

OSI 先有层级，后有协议；

TCP/IP 先有协议，后有层级

## 3. 信息传输介质

1. 磁介质

    > 低成本，短途运输速率高，延迟高
2. 双绞线

    > 即常用的网线。低噪声，低延迟，拥有足够的带宽，是目前应用最为广泛的信息传输介质
3. 同轴电缆

    > 带宽比双绞线大，抗噪性较好，主要用于 **长距离信息运输**
4. 电力线

    > 布置方便；但电源信号专用，频率不符，目前应用低
5. 光纤

    > 超高带宽，主要用于长距离通信
    > 光纤相对于铜线，具有高带宽，低衰减，重量轻，部署难，接口费用高 的特点


## 4. 多路复用

1. 频分复用

    > 将频谱分为几个频段，每个用户 **完全拥有** 其中一个频段进行通信。
    > OFDM 已经广泛应用于 802.11、有线电视网络和电力线网络
2. 时分复用

    > 用户以循环的方式轮流工作，周期性地获得 **整个带宽** 非常短的一个时间
    > TDM 广泛用于电话网络和蜂窝网络中
3. 码分复用

    > 通过码片来提取叠加信号中的信息。
    > 通过不同的码片序列来提取对应的信息，并将其他的信息都当做噪声
    > CDMA 被用于卫星通信和蜂窝网络以及有线电视网络

## 5. 数据链路层

数据链路层操作的对象是数据帧，向网络层提供服务，进行差错控制和流量控制。

### 5.1 分帧

1. 字节长度

    > 通过计算字节长度来分帧
    > 不准确，很少使用
2. 填充字节标志

    > 帧变长
    > 某些情况会干扰帧分界
3. 填充比特

    > 确保最小转换密度，有助于物理层保持同步
    > USB 使用该技术
4. 物理层编码违禁法

    > 通过使用一些物理层的违法编码或者冗余字节来进行分帧
    > 不需要填充数据

802.11 和以太网综合使用了上述方法（不包括字节长度）

### 5.2 差错检测和修正

#### 5.2.1 纠错码——不可靠信道(WIFI)

1. 海明码

    > 纠错存储器
    > 检测 $d$ 个错误，需要距离为 $d + 1$ 的编码方案
2. 卷积码

    > GSM 使用
3. 里德罗门码

    > 纠错能力强，处理突发错误能力强
    > 应用于光盘，卫星通信
4. 低密度奇偶校验

    > 纠错性能最佳
    > 使用于 802.11，数字广播，万兆以太

#### 5.2.2 检错码——可靠信道(光纤)

1. 奇偶校验

    > 只能检查一处错误
2. 校验和

    > 16 位字节和，可以检验奇偶校验检查不出的错误
3. 循环冗余检验

    > 多项式检验
    > 最可靠，使用最广泛
    > 使用于局域网和点到点连接

### 5.3 回退 N 步与选择重传

1. 停等协议

    > 直到接收到确认后才发下一帧
2. 回退 N 步

    > 不需要等到回报才发下一帧；而是直接发 $w$ 帧；
    > 如果 $w$ 个帧都没有回报，则堵塞。
    >
    > 出错时，直接丢弃，发送方回退，重新发送错误之后的帧。
    > 错误多时，影响带宽
3. 选择重传

    > 相比回退 N 步，不是由发送方回退 N 个窗口后重发；
    > 而是由接收方缓存接下来的帧，直到错误帧重发后，进行合并。
4. 两者的流量控制

    > 通过滑动窗口来进行流量控制。
    > 只有接收方的窗口滑动时（回报），发送方的窗口才能滑动
    > 回报没有拿到，则发送方的窗口阻塞，如果超时，则尝试重发

## 6. MAC 子层

1. MAC： Medium Access Control，介质访问控制子层


2. 用途： 用于确定多道访问中的下一个使用者


3. 使用原因

    > 多个网络使用者交流无序会导致混乱和信道拥塞，为了确定消息发送和传输测序，保证信道畅通。


### 6.1 信道分配

1. 静态分配

    > 用户固定一个信道
    > 无法解决突发流量问题

2. 动态分配假设

    > 单信道是核心；
    > 冲突可观察是最基本的的假设

### 6.2 多路访问协议

#### 6.2.1 ALOHA

##### 6.2.1.1 纯 ALOHA

1. 发送不受限制
2. 冲突的帧将损坏
3. 等待随机时间后重发
4. 最好的信道利用率为 18%


##### 6.2.1.2 分槽 ALOHA

1. 用户只能在下一个时间槽的开始时刻发送帧

    > 即帧的发送必须等待时间槽

2. 利用率： 37% 空槽，37% 成功， 26% 冲突


#### 6.2.2 载波侦听多路访问

称为 CSMA 协议。

CSMA： Carrier Sense Protocol

##### 6.2.2.1 坚持和非坚持

1. 1-坚持

    > 侦听信道，直到信道空闲
    > 冲突发生，等待随机时间后重发
    > 冲突的发生概率和信道带宽延迟积有关

2. 非坚持

    > 侦听信道，如果信道忙，随机等待
    > 其余与 1-坚持 相同


##### 6.2.2.2 带冲突检测的 CSMA

称为 CSMA/CD （CSMA with Collision Detection）

冲突检测：**传输时** 侦听信道，如果读回的信号不同于其发出的信号特征，则发生了冲突。

与普通 CSMA 的不同：CSMA/CD 会在检测到冲突后，立即停止帧的发送；而普通的 CSMA 不会

#### 6.2.3 无冲突协议

1. 位图协议

    > 通过在竞争槽中的对应槽插入位来向网络中广播站的发帧意愿
    > 高序号的站比低序号的站平均等待时间要短

2. 令牌协议

    > 令牌的拥有者具有发帧权限
    > 发帧与否，都必须将令牌传到下一站
    > 不存在高序号站和低序号站的差别

3. 二进制倒计数

    > 通过逻辑或来得到位时间
    > 站通过检测位时间和地址对应位的相同与否，来确定是否获取信道

#### 6.2.4 有限竞争协议

低负载下，竞争有利于提高延迟；

高负载下，采用无冲突技术能获取更好的信道效率。

通过给某些站赋予更高的成功获取信道的概率，或者增减时间槽内的站数量来实现。

#### 6.2.5 无线局域网冲突问题

由于无线覆盖范围的差别，站在开始传送时，无法知道接收方是否有无线电活动。

1. 隐藏终端问题

    > 由于竞争者离得太远，无法检测到潜在的竞争者

2. 暴露终端问题

    > 发送方相距太近，而接收方不在危险范围内，导致信道的浪费

解决办法称为 MACA （Multiple Access with Collision Avoidance） 冲突避免多路访问。

#### 6.2.6 冲突避免多路访问

发送方在发送帧之前，先发送一个 RTS 短帧；

接收方回报一个 CTS 短帧。

其他站检测到这两个帧，保持静默。

RTS： Request To Send

CTS: Clear To Send

### 6.3 以太网

#### 6.3.1 MAC 协议

MAC 地址有 6 字节， 48 位

<table>
<tr>
<td>8 字节</td>
<td>6</td>
<td>6</td>
<td>2</td>
<td>0-1500</td>
<td>0-46</td>
<td>4</td>
</tr>
<tr>
<td>前导码</td>
<td>目标地址</td>
<td>原地址</td>
<td>类型</td>
<td>数据</td>
<td>填充</td>
<td>校验和</td>
</tr>
</table>



1. 以太网限制有效帧至少 64 字节长

    > 防止由于帧过短导致传输时间短，从而引起冲突误判为非冲突


2. 二进制指数后退

    > 冲突后，在对应区间选择等待的时间槽数量 ($0 \sim 2^i -1 $)，最大为 1023
    > 冲突少时，确保低延迟；
    > 冲突多时，确保解决问题的时间间隔


#### 6.3.2 交换机和集线器的区别

交换机：

1. 全双工电缆不存在冲突问题
2. 通过缓冲来解决输出端口的冲突问题


### 6.4 802.11 WiFi MAC 协议

无线电存在信号弱，半双工特性，冲突代价大，所以试图去避免冲突。

1. 采用冲突避免 CSMA (CSMA/CA)

    > 在发送前侦听信道，和冲突后指数后退(等待时间槽)
    > 通过 ACK 来确认推断冲突是否发生

2. 使用 NAV 来确认信道忙的时间段

    > NAV 是在站自身管理的；
    > 在帧中夹带 NAV 信息，但是不单独传输 NAV

帧结构：

<table>
<tr>
<td>2 字节</td>
<td>2</td>
<td>6</td>
<td>6</td>
<td>6</td>
<td>2</td>
<td>0-2312</td>
<td>4</td>
</tr>

<tr>
<td>帧控制</td>
<td>持续时间</td>
<td>接收地址</td>
<td>发送地址</td>
<td>远端地址</td>
<td>序号</td>
<td>数据</td>
<td>帧检验序列</td>
</tr>
</table>

帧控制结构：

<table>
<tr>
<td>2 比特</td>
<td>2</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>

<tr>
<td>协议版本</td>
<td>类型</td>
<td>子类型</td>
<td>去往 DS</td>
<td>来自 DS</td>
<td>更多段</td>
<td>重传</td>
<td>电源管理</td>
<td>更多数据</td>
<td>受保护的</td>
<td>顺序</td>
</tr>
</table>

WiFi 定义了关联服务和重新关联服务。

关联服务用于连接 AP；

重新关联服务用于改变首选 AP。

WiFi 连接前必须验证，使用 WPA2


### 6.5 网桥


#### 6.5.1 网桥转发算法

1. 如果目标地址端口和源端口相同，丢弃该帧


2. 如果去往目标地址的端口与源端口不同，转发


3. 如果目标端口未知，进行泛洪，转发到除了源端口的所有其他端口


#### 6.5.2 生成树网桥

是为了解决由于网桥间存在 **冗余链路** 导致的 **泛洪循环** 问题。


通过确定根，通过根生成一个生成树来确保泛洪算法不出现循环。


### 6.6 VLAN

由于安全性，负载均衡，广播风暴问题，需要将 LAN 在内部分成多个 LAN 并进行动态调整，此时就出现了 VLAN。

通过虚拟的网桥来进行连接和交换， VLAN 通过在帧中加上 VLAN 协议(包括优先级和 VLAN 标识符) 来确定设备位置。

VLAN 兼容旧设备，在最后的 VLAN 端口处，有 VLAN 的帧会被还原为原来的普通数据帧。

## 7. 交换设备

1. 网关工作在 **应用层和传输层**


2. 路由器工作在 **网络层**


3. 网桥和交换机工作在 **数据链路层**


4. 中继器，集线器工作在 **物理层**
