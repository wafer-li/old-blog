HTMLElement.prototype.wrap=function(e){this.parentNode.insertBefore(e,this),this.parentNode.removeChild(this),e.appendChild(this)},NexT.utils={wrapImageWithFancyBox:function(){document.querySelectorAll(".post-body :not(a) > img, .post-body > img").forEach(e=>{var t=$(e),n=t.attr("data-src")||t.attr("src"),o=t.wrap(`<a class="fancybox fancybox.image" href="${n}" itemscope itemtype="http://schema.org/ImageObject" itemprop="url"></a>`).parent("a");t.is(".post-gallery img")?(o.addClass("post-gallery-img"),o.attr("data-fancybox","gallery").attr("rel","gallery")):t.is(".group-picture img")?o.attr("data-fancybox","group").attr("rel","group"):o.attr("data-fancybox","default").attr("rel","default");var a=t.attr("title")||t.attr("alt");a&&(o.append(`<p class="image-caption">${a}</p>`),o.attr("title",a).attr("data-caption",a))}),$.fancybox.defaults.hash=!1,$(".fancybox").fancybox({loop:!0,helpers:{overlay:{locked:!1}}})},registerExtURL:function(){document.querySelectorAll(".exturl").forEach(e=>{e.addEventListener("click",e=>{var t=e.currentTarget.getAttribute("data-url"),n=decodeURIComponent(escape(window.atob(t)));return window.open(n,"_blank","noopener"),!1})})},registerCopyCode:function(){document.querySelectorAll("figure.highlight").forEach(e=>{const t=e=>{"mac"===CONFIG.copycode.style?e.innerHTML='<i class="fa fa-clipboard"></i>':e.innerText=CONFIG.translation.copy_button},n=document.createElement("div");n.classList.add("highlight-wrap"),e.wrap(n),e.parentNode.insertAdjacentHTML("beforeend",'<div class="copy-btn"></div>');var o=e.parentNode.querySelector(".copy-btn");o.addEventListener("click",e=>{var t=e.currentTarget,n=[...t.parentNode.querySelectorAll(".code .line")].map(e=>e.innerText).join("\n"),o=document.createElement("textarea"),a=window.scrollY;o.style.top=a+"px",o.style.position="absolute",o.style.opacity="0",o.readOnly=!0,o.value=n,document.body.append(o);const r=document.getSelection(),i=r.rangeCount>0&&r.getRangeAt(0);o.select(),o.setSelectionRange(0,n.length),o.readOnly=!1;var c=document.execCommand("copy");CONFIG.copycode.show_result&&(t.innerText=c?CONFIG.translation.copy_success:CONFIG.translation.copy_failure),o.blur(),t.blur(),i&&(r.removeAllRanges(),r.addRange(i)),document.body.removeChild(o)}),o.addEventListener("mouseleave",e=>{setTimeout(()=>{t(e.target)},300)}),t(o)})},wrapTableWithBox:function(){document.querySelectorAll("table").forEach(e=>{const t=document.createElement("div");t.className="table-container",e.wrap(t)})},registerVideoIframe:function(){document.querySelectorAll("iframe").forEach(e=>{if(["www.youtube.com","player.vimeo.com","player.youku.com","player.bilibili.com","www.tudou.com"].some(t=>e.src.includes(t))&&!e.parentNode.matches(".video-container")){const t=document.createElement("div");t.className="video-container",e.wrap(t);let n=Number(e.width),o=Number(e.height);n&&o&&(e.parentNode.style.paddingTop=o/n*100+"%")}})},registerScrollPercent:function(){var e=document.querySelector(".back-to-top"),t=document.querySelector(".reading-progress-bar");window.addEventListener("scroll",()=>{var n;if(e||t){var o=document.querySelector(".container").offsetHeight,a=window.innerHeight,r=o>a?o-a:document.body.scrollHeight-a,i=Math.round(100*window.scrollY/r);n=Math.min(i,100)+"%"}e&&(e.classList.toggle("back-to-top-on",window.scrollY>50),e.querySelector("span").innerText=n),t&&(t.style.width=n)}),e&&e.addEventListener("click",()=>{window.anime({targets:[document.documentElement,document.body],duration:500,easing:"linear",scrollTop:0})})},registerTabsTag:function(){document.querySelectorAll(".tabs ul.nav-tabs .tab").forEach(e=>{e.addEventListener("click",e=>{e.preventDefault();var t=e.currentTarget;if(!t.classList.contains("active")){[...t.parentNode.children].forEach(e=>{e.classList.remove("active")}),t.classList.add("active");var n=document.getElementById(t.querySelector("a").getAttribute("href").replace("#",""));[...n.parentNode.children].forEach(e=>{e.classList.remove("active")}),n.classList.add("active"),n.dispatchEvent(new Event("tabs:click",{bubbles:!0}))}})}),window.dispatchEvent(new Event("tabs:register"))},registerCanIUseTag:function(){window.addEventListener("message",e=>{var t=e.data;if("string"==typeof t&&t.indexOf("ciu_embed")>-1){var n=t.split(":")[1],o=t.split(":")[2];document.querySelector(`iframe[data-feature=${n}]`).style.height=parseInt(o,10)+"px"}},!1)},registerActiveMenuItem:function(){document.querySelectorAll(".menu-item").forEach(e=>{var t=e.querySelector("a[href]");if(t){var n=t.pathname===location.pathname||t.pathname===location.pathname.replace("index.html",""),o=t.pathname!==CONFIG.root&&0===location.pathname.indexOf(t.pathname);e.classList.toggle("menu-item-active",t.hostname===location.hostname&&(n||o))}})},registerSidebarTOC:function(){const e=document.querySelectorAll(".post-toc li"),t=[...e].map(e=>{var t=e.querySelector("a.nav-link");return t.addEventListener("click",e=>{e.preventDefault();var t=document.getElementById(e.currentTarget.getAttribute("href").replace("#","")).getBoundingClientRect().top+window.scrollY;window.anime({targets:[document.documentElement,document.body],duration:500,easing:"linear",scrollTop:t+10})}),document.getElementById(t.getAttribute("href").replace("#",""))});var n=document.querySelector(".post-toc-wrap");!function o(a){a=Math.floor(a+1e4);let r=new IntersectionObserver((r,i)=>{let c=document.documentElement.scrollHeight+100;if(c>a)return i.disconnect(),void o(c);let s=function(e){let n=0,o=e[n];if(o.boundingClientRect.top>0)return 0===(n=t.indexOf(o.target))?0:n-1;for(;n<e.length;n++){if(!(e[n].boundingClientRect.top<=0))return t.indexOf(o.target);o=e[n]}return t.indexOf(o.target)}(r);!function(e){if(!e.classList.contains("active-current")){document.querySelectorAll(".post-toc .active").forEach(e=>{e.classList.remove("active","active-current")}),e.classList.add("active","active-current");for(var t=e.parentNode;!t.matches(".post-toc");)t.matches("li")&&t.classList.add("active"),t=t.parentNode;window.anime({targets:n,duration:200,easing:"linear",scrollTop:n.scrollTop-n.offsetHeight/2+e.getBoundingClientRect().top-n.getBoundingClientRect().top})}}(e[s])},{rootMargin:a+"px 0px -100% 0px",threshold:0});t.forEach(e=>{e&&r.observe(e)})}(document.documentElement.scrollHeight)},hasMobileUA:function(){var e=navigator.userAgent;return/iPad|iPhone|Android|Opera Mini|BlackBerry|webOS|UCWEB|Blazer|PSP|IEMobile|Symbian/g.test(e)},isTablet:function(){return window.screen.width<992&&window.screen.width>767&&this.hasMobileUA()},isMobile:function(){return window.screen.width<767&&this.hasMobileUA()},isDesktop:function(){return!this.isTablet()&&!this.isMobile()},isMuse:function(){return"Muse"===CONFIG.scheme},isMist:function(){return"Mist"===CONFIG.scheme},isPisces:function(){return"Pisces"===CONFIG.scheme},isGemini:function(){return"Gemini"===CONFIG.scheme},initSidebarDimension:function(){var e=document.querySelector(".sidebar-nav"),t="none"!==e.style.display?e.offsetHeight:0,n=CONFIG.sidebar.offset||12,o=CONFIG.back2top.enable&&CONFIG.back2top.sidebar?document.querySelector(".back-to-top").offsetHeight:0,a=CONFIG.sidebarPadding+t+o;(NexT.utils.isPisces()||NexT.utils.isGemini())&&(a+=2*n-12);var r=document.body.offsetHeight-a+"px";document.querySelector(".site-overview-wrap").style.maxHeight=r,document.querySelector(".post-toc-wrap").style.maxHeight=r},updateSidebarPosition:function(){var e=document.querySelector(".sidebar-nav"),t=document.querySelector(".post-toc");if(t?(e.style.display="",e.classList.add("motion-element"),document.querySelector(".sidebar-nav-toc").click()):(e.style.display="none",e.classList.remove("motion-element"),document.querySelector(".sidebar-nav-overview").click()),NexT.utils.initSidebarDimension(),this.isDesktop()&&!this.isPisces()&&!this.isGemini()){var n=CONFIG.page.sidebar;"boolean"!=typeof n&&(n="always"===CONFIG.sidebar.display||"post"===CONFIG.sidebar.display&&t),n&&window.dispatchEvent(new Event("sidebar:show"))}},getScript:function(e,t,n){if(n)t();else{var o=document.createElement("script");o.onload=o.onreadystatechange=function(e,n){(n||!o.readyState||/loaded|complete/.test(o.readyState))&&(o.onload=o.onreadystatechange=null,o=void 0,!n&&t&&setTimeout(t,0))},o.src=e,document.head.appendChild(o)}}};;window.$&&window.$.Velocity&&(window.Velocity=window.$.Velocity),NexT.motion={},NexT.motion.integrator={queue:[],cursor:-1,init:function(){return this.queue=[],this.cursor=-1,this},add:function(t){return this.queue.push(t),this},next:function(){this.cursor++;var t=this.queue[this.cursor];"function"==typeof t&&t(NexT.motion.integrator)},bootstrap:function(){this.next()}},NexT.motion.middleWares={logo:function(t){var o=[],e=document.querySelector(".brand"),i=document.querySelector(".custom-logo-image"),n=document.querySelector(".site-title"),s=document.querySelector(".site-subtitle"),r=document.querySelector(".logo-line-before i"),u=document.querySelector(".logo-line-after i");function c(t,o){return{e:t,p:{translateX:o},o:{duration:500,sequenceQueue:!1}}}function l(){o.push({e:i,p:{opacity:1,top:0},o:{duration:200}})}e&&o.push({e:e,p:{opacity:1},o:{duration:200}}),NexT.utils.isMist()&&r&&u&&o.push(c(r,"100%"),c(u,"-100%")),NexT.utils.isMuse()&&i&&l(),n&&o.push({e:n,p:{opacity:1,top:0},o:{duration:200}}),s&&o.push({e:s,p:{opacity:1,top:0},o:{duration:200}}),(NexT.utils.isPisces()||NexT.utils.isGemini())&&i&&l(),o.length>0?(o[o.length-1].o.complete=function(){t.next()},Velocity.RunSequence(o)):t.next(),CONFIG.motion.async&&t.next()},menu:function(t){Velocity(document.querySelectorAll(".menu-item"),"transition.slideDownIn",{display:null,duration:200,complete:function(){t.next()}}),CONFIG.motion.async&&t.next()},postList:function(t){var o=document.querySelectorAll(".post-block, .pagination, .comments"),e=CONFIG.motion.transition.post_block,i=document.querySelectorAll(".post-header"),n=CONFIG.motion.transition.post_header,s=document.querySelectorAll(".post-body"),r=CONFIG.motion.transition.post_body,u=document.querySelectorAll(".collection-header"),c=CONFIG.motion.transition.coll_header;if(o.length>0){var l=window.postMotionOptions||{stagger:100,drag:!0,complete:function(){t.next()}};CONFIG.motion.transition.post_block&&Velocity(o,"transition."+e,l),CONFIG.motion.transition.post_header&&Velocity(i,"transition."+n,l),CONFIG.motion.transition.post_body&&Velocity(s,"transition."+r,l),CONFIG.motion.transition.coll_header&&Velocity(u,"transition."+c,l)}(NexT.utils.isPisces()||NexT.utils.isGemini())&&t.next()},sidebar:function(t){var o=document.querySelector(".sidebar-inner"),e=CONFIG.motion.transition.sidebar;e&&(NexT.utils.isPisces()||NexT.utils.isGemini())&&Velocity(o,"transition."+e,{display:null,duration:200,complete:function(){o.style.transform="initial"}}),t.next()}};;var Affix={init:function(t,e){this.element=t,this.offset=e||0,this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition(),window.addEventListener("scroll",this.checkPosition.bind(this)),window.addEventListener("click",this.checkPositionWithEventLoop.bind(this)),window.matchMedia("(min-width: 992px)").addListener(t=>{t.matches&&(this.offset=NexT.utils.getAffixParam(),this.checkPosition())})},getState:function(t,e,i,n){let o=window.scrollY,s=window.innerHeight;if(null!=i&&"top"===this.affixed)return o<i&&"top";if("bottom"===this.affixed)return null!=i?!(this.unpin<=this.element.getBoundingClientRect().top)&&"bottom":!(o+s<=t-n)&&"bottom";let f=null===this.affixed,l=f?o:this.element.getBoundingClientRect().top+o;return null!=i&&o<=i?"top":null!=n&&l+(f?s:e)>=t-n&&"bottom"},getPinnedOffset:function(){return this.pinnedOffset?this.pinnedOffset:(this.element.classList.remove("affix-top","affix-bottom"),this.element.classList.add("affix"),this.pinnedOffset=this.element.getBoundingClientRect().top)},checkPositionWithEventLoop(){setTimeout(this.checkPosition.bind(this),1)},checkPosition:function(){if("none"===window.getComputedStyle(this.element).display)return;let t=this.element.offsetHeight-CONFIG.sidebarPadding,e=this.offset,i=e.top,n=e.bottom,o=document.body.scrollHeight,s=this.getState(o,t,i,n);if(this.affixed!==s){null!=this.unpin&&(this.element.style.top="");let t="affix"+(s?"-"+s:"");this.affixed=s,this.unpin="bottom"===s?this.getPinnedOffset():null,this.element.classList.remove("affix","affix-top","affix-bottom"),this.element.classList.add(t)}"bottom"===s&&(this.element.style.top=o-t-n+"px")}};NexT.utils.getAffixParam=function(){const t=CONFIG.sidebar.offset||12;let e=document.querySelector(".header-inner").offsetHeight+t,i=document.querySelector(".footer"),n=document.querySelector(".footer-inner"),o=i.offsetHeight-n.offsetHeight,s=i.offsetHeight+o;return document.querySelector(".sidebar").style.marginTop=e+"px",{top:e-t,bottom:s}},window.addEventListener("DOMContentLoaded",()=>{Affix.init(document.querySelector(".sidebar-inner"),NexT.utils.getAffixParam())});;NexT.boot={},NexT.boot.registerEvents=function(){NexT.utils.registerScrollPercent(),NexT.utils.registerCanIUseTag(),document.querySelector(".site-nav-toggle .toggle").addEventListener("click",()=>{event.currentTarget.classList.toggle("toggle-close");var e=document.querySelector(".site-nav"),t=e.classList.contains("site-nav-on")?"slideUp":"slideDown";"function"==typeof Velocity?Velocity(e,t,{duration:200,complete:function(){e.classList.toggle("site-nav-on")}}):e.classList.toggle("site-nav-on")});document.querySelectorAll(".sidebar-nav li").forEach((e,t)=>{e.addEventListener("click",e=>{var i=e.currentTarget;if(!i.classList.contains("sidebar-nav-active")){var o=document.querySelectorAll(".sidebar-panel"),a=o[t],s=o[1-t];window.anime({targets:s,duration:200,easing:"linear",opacity:0,complete:()=>{s.classList.remove("sidebar-panel-active"),a.style.opacity=0,a.classList.add("sidebar-panel-active"),window.anime({targets:a,duration:200,easing:"linear",opacity:1})}}),[...i.parentNode.children].forEach(e=>{e.classList.remove("sidebar-nav-active")}),i.classList.add("sidebar-nav-active")}})}),window.addEventListener("resize",NexT.utils.initSidebarDimension),window.addEventListener("hashchange",()=>{var e=location.hash;if(""!==e&&!e.match(/%\S{2}/)){var t=document.querySelector(`.tabs ul.nav-tabs li a[href="${e}"]`);t&&t.click()}})},NexT.boot.refresh=function(){CONFIG.fancybox&&NexT.utils.wrapImageWithFancyBox(),CONFIG.mediumzoom&&window.mediumZoom(".post-body :not(a) > img, .post-body > img"),CONFIG.lazyload&&window.lozad(".post-body img").observe(),CONFIG.pangu&&window.pangu.spacingPage(),CONFIG.exturl&&NexT.utils.registerExtURL(),CONFIG.copycode.enable&&NexT.utils.registerCopyCode(),NexT.utils.registerTabsTag(),NexT.utils.registerActiveMenuItem(),NexT.utils.registerSidebarTOC(),NexT.utils.wrapTableWithBox(),NexT.utils.registerVideoIframe()},NexT.boot.motion=function(){CONFIG.motion.enable&&NexT.motion.integrator.add(NexT.motion.middleWares.logo).add(NexT.motion.middleWares.menu).add(NexT.motion.middleWares.postList).add(NexT.motion.middleWares.sidebar).bootstrap(),NexT.utils.updateSidebarPosition()},window.addEventListener("DOMContentLoaded",()=>{NexT.boot.registerEvents(),NexT.boot.refresh(),NexT.boot.motion()});;window.addEventListener("DOMContentLoaded",()=>{"use strict";var e=()=>{localStorage.setItem("bookmark"+location.pathname,window.scrollY)},o=()=>{var e=localStorage.getItem("bookmark"+location.pathname);e=parseInt(e,10),isNaN(e)||""!==location.hash||window.anime({targets:[document.documentElement,document.body],duration:200,easing:"linear",scrollTop:e})};!function(t){var n=document.querySelector(".book-mark-link");window.addEventListener("scroll",()=>n.classList.toggle("book-mark-link-fixed",0===window.scrollY)),"auto"===t&&(window.addEventListener("beforeunload",e),window.addEventListener("pjax:send",e)),n.addEventListener("click",()=>{e(),window.anime({targets:n,duration:200,easing:"linear",top:-30,complete:()=>{setTimeout(()=>{n.style.top=""},400)}})}),o(),window.addEventListener("pjax:success",o)}(CONFIG.bookmark.save)});;window.addEventListener("DOMContentLoaded",()=>{let e,t=!1,r=!0,n=CONFIG.path;0===n.length?n="search.xml":/json$/i.test(n)&&(r=!1);const o=CONFIG.root+n,l=document.getElementById("search-input"),s=document.getElementById("search-result"),c=(e,t,r)=>{let n=e.length;if(0===n)return[];let o=0,l=[],s=[];for(r||(t=t.toLowerCase(),e=e.toLowerCase());(l=t.indexOf(e,o))>-1;)s.push({position:l,word:e}),o=l+n;return s},a=(e,t,r,n)=>{let o=r[r.length-1],l=o.position,s=o.word,c=[],a=0;for(;l+s.length<=t&&0!==r.length;){s===n&&a++,c.push({position:l,length:s.length});let e=l+s.length;for(r.pop();0!==r.length&&(l=(o=r[r.length-1]).position,s=o.word,e>l);)r.pop()}return{hits:c,start:e,end:t,searchTextCount:a}},i=(e,t)=>{let r="",n=t.start;return t.hits.forEach(t=>{r+=e.substring(n,t.position);let o=t.position+t.length;r+=`<b class="search-keyword">${e.substring(t.position,o)}</b>`,n=o}),r+=e.substring(n,t.end)},h=()=>{let t=l.value.trim().toLowerCase(),r=t.split(/[-\s]+/);r.length>1&&r.push(t);let n=[];if(t.length>0&&e.forEach(e=>{if(!e.title)return;let o=0,l=e.title.trim(),s=l.toLowerCase(),h=e.content?e.content.trim().replace(/<[^>]+>/g,""):"";CONFIG.localsearch.unescape&&(h=(e=>String(e).replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&#x3A;/g,":").replace(/&#(\d+);/g,(e,t)=>String.fromCharCode(t)).replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"))(h));let u=h.toLowerCase(),p=decodeURIComponent(e.url).replace(/\/{2,}/g,"/"),d=[],g=[];if(r.forEach(e=>{d=d.concat(c(e,s,!1)),g=g.concat(c(e,u,!1))}),d.length>0||g.length>0){let e=d.length+g.length;[d,g].forEach(e=>{e.sort((e,t)=>t.position!==e.position?t.position-e.position:e.word.length-t.word.length)});let r=[];if(0!==d.length){let e=a(0,l.length,d,t);o+=e.searchTextCountInSlice,r.push(e)}let s=[];for(;0!==g.length;){let e=g[g.length-1],r=e.position,n=e.word,l=r-20,c=r+80;l<0&&(l=0),c<r+n.length&&(c=r+n.length),c>h.length&&(c=h.length);let i=a(l,c,g,t);o+=i.searchTextCountInSlice,s.push(i)}s.sort((e,t)=>e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hits.length!==t.hits.length?t.hits.length-e.hits.length:e.start-t.start);let c=parseInt(CONFIG.localsearch.top_n_per_article,10);c>=0&&(s=s.slice(0,c));let u="";0!==r.length?u+=`<li><a href="${p}" class="search-result-title">${i(l,r[0])}</a>`:u+=`<li><a href="${p}" class="search-result-title">${l}</a>`,s.forEach(e=>{u+=`<a href="${p}"><p class="search-result">${i(h,e)}...</p></a>`}),u+="</li>",n.push({item:u,searchTextCount:o,hitCount:e,id:n.length})}}),1===r.length&&""===r[0])s.innerHTML='<div id="no-result"><i class="fa fa-search fa-5x"></i></div>';else if(0===n.length)s.innerHTML='<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>';else{n.sort((e,t)=>e.searchTextCount!==t.searchTextCount?t.searchTextCount-e.searchTextCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id);let e='<ul class="search-result-list">';n.forEach(t=>{e+=t.item}),e+="</ul>",s.innerHTML=e,window.pjax&&window.pjax.refresh(s)}},u=n=>{fetch(o).then(e=>e.text()).then(o=>{t=!0,e=r?[...(new DOMParser).parseFromString(o,"text/xml").querySelectorAll("entry")].map(e=>({title:e.querySelector("title").innerHTML,content:e.querySelector("content").innerHTML,url:e.querySelector("url").innerHTML})):JSON.parse(o),document.querySelector(".search-pop-overlay").innerHTML="",document.body.style.overflow="",n&&n()})};CONFIG.localsearch.preload&&u();const p=()=>{document.body.style.overflow="hidden",document.querySelector(".search-pop-overlay").style.display="block",document.querySelector(".popup").style.display="block",document.getElementById("search-input").focus()};"auto"===CONFIG.localsearch.trigger?l.addEventListener("input",h):(document.querySelector(".search-icon").addEventListener("click",h),l.addEventListener("keypress",e=>{13===e.keyCode&&h()})),document.querySelector(".popup-trigger").addEventListener("click",()=>{!1===t?(document.querySelector(".search-pop-overlay").style.display="",document.querySelector(".search-pop-overlay").innerHTML='<div class="search-loading-icon"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div>',u(p)):p()});const d=()=>{document.body.style.overflow="",document.querySelector(".search-pop-overlay").style.display="none",document.querySelector(".popup").style.display="none"};document.querySelector(".search-pop-overlay").addEventListener("click",d),document.querySelector(".popup-btn-close").addEventListener("click",d),window.addEventListener("pjax:success",d),window.addEventListener("keyup",e=>{27===e.which&&d()})});